<?php
    $rowOpen = false;
?>
<?php foreach ($fields as $field): ?>
    <?php if ($field->span === 'row' && !$rowOpen): $rowOpen = true; ?>
        <div class="row">
    <?php endif ?>
    <?php if ($field->span !== 'row' && $rowOpen): $rowOpen = false; ?>
        </div>
    <?php endif ?>
    <?= $this->makePartial('field-container', ['field' => $field]) ?>
<?php endforeach ?>
<?php if ($rowOpen): $rowOpen = false; ?>
    </div>
<?php endif ?>
